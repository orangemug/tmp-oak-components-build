{"version":3,"file":"OakQuizCheckBox.js","sources":["../../../../../../../src/components/organisms/pupil/quiz/OakQuizCheckBox/OakQuizCheckBox.tsx"],"sourcesContent":["import React, { useRef } from \"react\";\nimport styled, { css } from \"styled-components\";\n\nimport { OakBox, OakFlex, OakFlexProps, OakIcon } from \"@/components/atoms\";\nimport { InternalCheckBoxWrapper } from \"@/components/atoms/InternalCheckBoxWrapper\";\nimport { InternalCheckBoxLabelHoverDecor } from \"@/components/atoms/InternalCheckBoxLabel\";\nimport {\n  BaseCheckBoxProps,\n  InternalCheckBox,\n} from \"@/components/atoms/InternalCheckBox/InternalCheckBox\";\nimport { parseColor } from \"@/styles/helpers/parseColor\";\nimport { parseBorder } from \"@/styles/helpers/parseBorder\";\nimport { parseBorderRadius } from \"@/styles/helpers/parseBorderRadius\";\nimport { parseDropShadow } from \"@/styles/helpers/parseDropShadow\";\nimport { OakCombinedColorToken } from \"@/styles\";\n\nconst StyledInternalCheckBox = styled(InternalCheckBox)`\n  &:checked:not(:disabled) {\n    border: ${parseBorder(\"border-solid-l\")};\n    border-color: ${parseColor(\"border-primary\")};\n  }\n\n  &:checked:disabled {\n    border: ${parseBorder(\"border-solid-l\")};\n    border-color: ${parseColor(\"text-disabled\")};\n  }\n\n  @media (hover: hover) {\n    &:hover:not(:disabled) {\n      background: ${parseColor(\"bg-primary\")};\n    }\n  }\n`;\n\ntype StyledFlexBoxProps = OakFlexProps & {\n  $overlayBorderColor: OakCombinedColorToken;\n  $feedbackBgColor?: OakCombinedColorToken;\n  $outlineColor: OakCombinedColorToken;\n};\n\nconst StyledFlexBox = styled(OakFlex)<StyledFlexBoxProps>`\n  &:not(:focus-within) {\n    ${(props) =>\n      !!props.$outlineColor &&\n      css`\n        outline: ${parseBorder(\"border-solid-xl\")}\n          ${parseColor(props.$outlineColor)};\n      `}\n  }\n\n  &:has(input:not(:disabled)) {\n    cursor: pointer;\n  }\n\n  &:has(input:disabled) {\n    pointer-events: none;\n    cursor: none;\n  }\n\n  &:focus-within {\n    box-shadow: ${parseDropShadow(\"drop-shadow-centered-lemon\")},\n      ${parseDropShadow(\"drop-shadow-centered-grey\")};\n  }\n\n  @media (hover: hover) {\n    &:hover:has(input:not(:disabled)) {\n      background-color: ${parseColor(\"bg-decorative1-subdued\")};\n    }\n\n    &:hover input:not(:disabled) {\n      background: ${parseColor(\"bg-primary\")};\n    }\n\n    &:hover:has(input:not(:disabled)) ${InternalCheckBoxLabelHoverDecor} {\n      text-decoration: underline;\n    }\n\n    &:hover:has(\n        ${InternalCheckBoxLabelHoverDecor}\n          input:not(:focus-visible):not(:checked):not(:disabled)\n      )::after {\n      content: \"\";\n      inset: 0;\n      pointer-events: none;\n      position: absolute;\n      border-bottom: ${parseBorder(\"border-solid-xl\")};\n      border-radius: ${parseBorderRadius(\"border-radius-m2\")};\n    }\n\n    &:focus-within {\n      box-shadow: ${parseDropShadow(\"drop-shadow-centered-lemon\")},\n        ${parseDropShadow(\"drop-shadow-centered-grey\")};\n    }\n\n    &:has(input:checked:not(:disabled)) {\n      outline: ${parseBorder(\"border-solid-xl\")};\n    }\n\n    &:has(input:checked:disabled) {\n      outline-color: ${(props) => css`\n        ${parseColor(props.$overlayBorderColor)}\n      `};\n    }\n\n    &:has(input:disabled:not(:checked)) {\n      ${(props) =>\n        props.$feedbackBgColor\n          ? css`\n              background-color: ${props.$feedbackBgColor};\n            `\n          : undefined}\n    }\n\n    &:has(input:disabled:checked) {\n      ${(props) => css`\n        background-color: ${parseColor(props.$feedbackBgColor)};\n      `};\n    }\n  }\n`;\n\nexport type OakQuizCheckBoxProps = Omit<BaseCheckBoxProps, \"defaultChecked\"> & {\n  feedback?: \"correct\" | \"incorrect\" | null;\n  image?: React.JSX.Element;\n  innerRef?: React.RefObject<HTMLInputElement>;\n  displayValue?: string | React.JSX.Element;\n  /**\n   * Give the field a highlight to draw attention to it\n   */\n  isHighlighted?: boolean;\n};\n\n/**\n * A checkbox representing the options in a multiple choice question.\n */\nexport const OakQuizCheckBox = (props: OakQuizCheckBoxProps) => {\n  const {\n    id,\n    value,\n    feedback,\n    image,\n    disabled,\n    innerRef,\n    displayValue,\n    isHighlighted,\n    ...rest\n  } = props;\n\n  const isFeedback = !!feedback;\n\n  const defaultRef = useRef<HTMLInputElement>(null);\n  const inputRef = innerRef ?? defaultRef;\n  const showTick =\n    (feedback === \"correct\" && inputRef.current?.checked) ||\n    (feedback === \"incorrect\" && !inputRef.current?.checked);\n  const showCross = feedback === \"incorrect\" && inputRef.current?.checked;\n\n  const handleContainerClick = (\n    e:\n      | React.MouseEvent<HTMLDivElement>\n      | React.MouseEvent<HTMLInputElement>\n      | React.MouseEvent<HTMLLabelElement>,\n  ) => {\n    const inputId = (e.target as HTMLInputElement).id;\n\n    if (inputId !== id) {\n      inputRef.current?.click();\n    }\n  };\n\n  const imageContainer = (\n    <OakFlex\n      $flexDirection=\"column\"\n      $minWidth={\"all-spacing-20\"}\n      $gap={\"space-between-s\"}\n    >\n      <OakBox>{image}</OakBox>\n      {displayValue}\n    </OakFlex>\n  );\n\n  const feedbackBgColor = showTick ? \"bg-correct\" : \"bg-incorrect\";\n  const feedbackBorderColor = showTick ? \"border-success\" : \"border-error\";\n\n  const inputCheckbox = (\n    <StyledFlexBox\n      $pa=\"inner-padding-l\"\n      $borderRadius={\"border-radius-m2\"}\n      $borderColor={\n        isHighlighted ? \"border-decorative5-stronger\" : \"border-primary\"\n      }\n      $background={\n        disabled && !isFeedback ? \"bg-neutral-stronger\" : \"bg-primary\"\n      }\n      $flexGrow={1}\n      onClick={handleContainerClick}\n      $overlayBorderColor={isFeedback ? feedbackBorderColor : \"text-disabled\"}\n      $feedbackBgColor={isFeedback ? feedbackBgColor : undefined}\n      $outlineColor={\n        isHighlighted ? \"border-decorative5-stronger\" : \"transparent\"\n      }\n    >\n      <InternalCheckBoxLabelHoverDecor\n        pointerEvents=\"none\"\n        htmlFor={id}\n        labelGap={\"space-between-s\"}\n        labelAlignItems={\"center\"}\n        $color={disabled && !isFeedback ? \"text-disabled\" : \"text-primary\"}\n        $font={\"body-1\"}\n        disabled={disabled}\n      >\n        <InternalCheckBoxWrapper\n          size={\"all-spacing-7\"}\n          iconPadding=\"inner-padding-ssx\"\n          checkedIcon={\n            <OakBox\n              $width=\"100%\"\n              $height=\"100%\"\n              $background={\n                disabled || isFeedback ? \"text-disabled\" : \"text-primary\"\n              }\n            >\n              <OakBox\n                $ba={\"border-solid-m\"}\n                $borderColor={\"white\"}\n                $width={\"100%\"}\n                $height={\"100%\"}\n              />\n            </OakBox>\n          }\n          internalCheckbox={\n            <StyledInternalCheckBox\n              id={id}\n              value={value}\n              disabled={disabled || isFeedback}\n              {...rest}\n              $width={\"all-spacing-7\"}\n              $height={\"all-spacing-7\"}\n              $ba={\"border-solid-m\"}\n              $borderColor=\"border-neutral\"\n              $borderRadius={\"border-radius-s\"}\n              $background={isHighlighted ? \"bg-decorative5-main\" : \"bg-primary\"}\n              $checkedBackground={null}\n              ref={inputRef}\n            />\n          }\n        />\n        {image ? imageContainer : displayValue}\n      </InternalCheckBoxLabelHoverDecor>\n      {isFeedback && (showTick || showCross) && (\n        <OakFlex\n          className=\"feedbackIconWrapper\"\n          $flexGrow={1}\n          $justifyContent={\"flex-end\"}\n          $alignItems={\"flex-end\"}\n          $height={\"100%\"}\n        >\n          {showTick && (\n            <OakIcon\n              iconName={\"tick\"}\n              $colorFilter={\"icon-success\"}\n              alt={\n                feedback === \"correct\" ? \"Correct\" : \"Unselected correct choice\"\n              }\n            />\n          )}\n          {showCross && (\n            <OakIcon\n              iconName={\"cross\"}\n              $colorFilter={\"icon-error\"}\n              alt={\"Incorrect\"}\n            />\n          )}\n        </OakFlex>\n      )}\n    </StyledFlexBox>\n  );\n\n  return (\n    <OakFlex $width={\"100%\"} $position={\"relative\"}>\n      {inputCheckbox}\n    </OakFlex>\n  );\n};\n"],"names":["StyledInternalCheckBox","styled","InternalCheckBox","parseBorder","parseColor","StyledFlexBox","OakFlex","props","$outlineColor","css","parseDropShadow","InternalCheckBoxLabelHoverDecor","parseBorderRadius","$overlayBorderColor","$feedbackBgColor","undefined","id","value","feedback","image","disabled","innerRef","displayValue","isHighlighted","rest","isFeedback","defaultRef","useRef","inputRef","showTick","current","checked","showCross","imageContainer","React","createElement","$minWidth","$gap","OakBox","feedbackBgColor","feedbackBorderColor","inputCheckbox","$pa","$borderRadius","$borderColor","$background","$flexGrow","onClick","e","target","click","pointerEvents","htmlFor","labelGap","labelAlignItems","$color","$font","InternalCheckBoxWrapper","size","iconPadding","checkedIcon","$width","$height","$ba","internalCheckbox","default","$checkedBackground","ref","className","$alignItems","OakIcon","iconName","$colorFilter","alt","$position"],"mappings":"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"}