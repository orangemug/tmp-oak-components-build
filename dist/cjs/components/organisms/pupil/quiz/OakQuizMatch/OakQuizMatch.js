"use strict";var e=require("react"),a=require("@dnd-kit/core"),r=require("@dnd-kit/sortable"),t=require("../InternalDroppableHoldingPen/InternalDroppableHoldingPen.js");require("../../../../atoms/OakAnchorTarget/OakAnchorTarget.js"),require("../../../../atoms/OakAspectRatio/OakAspectRatio.js"),require("../../../../atoms/OakBox/OakBox.js"),require("../../../../atoms/OakCloudinaryImage/OakCloudinaryImage.js");var n=require("../../../../atoms/OakFlex/OakFlex.js");require("../../../../atoms/OakForm/OakForm.js"),require("../../../../atoms/OakGlobalStyle/OakGlobalStyle.js"),require("../../../../atoms/OakGrid/OakGrid.js"),require("../../../../atoms/OakGridArea/OakGridArea.js"),require("../../../../atoms/OakHeading/OakHeading.js"),require("../../../../atoms/OakImage/OakImage.js"),require("../../../../atoms/OakSpan/OakSpan.js"),require("../../../../atoms/OakLI/OakLI.js"),require("../../../../atoms/OakLabel/OakLabel.js"),require("../../../../atoms/OakMaxWidth/OakMaxWidth.js"),require("../../../../atoms/OakOL/OakOL.js"),require("../../../../atoms/OakFieldset/OakFieldset.js"),require("../../../../atoms/OakP/OakP.js"),require("../../../../atoms/OakScreenReader/OakScreenReader.js"),require("styled-components"),require("../../../../atoms/OakTypography/OakTypography.js"),require("../../../../atoms/OakUL/OakUL.js"),require("../../../../atoms/OakSvg/OakSvg.js"),require("../../../../molecules/OakAccordion/OakAccordion.js"),require("../../../../molecules/OakBackLink/OakBackLink.js"),require("../../../../molecules/OakButtonAsRadioGroup/OakButtonAsRadioGroup.js"),require("../../../../atoms/InternalCardWithBackgroundElement/InternalCardWithBackgroundElement.js"),require("../../../../atoms/InternalStyledSvg/InternalStyledSvg.js"),require("../../../../atoms/InternalCheckBox/InternalCheckBox.js"),require("../../../../atoms/InternalCheckBoxLabel/InternalCheckBoxLabel.js"),require("../../../../atoms/InternalCheckBoxWrapper/InternalCheckBoxWrapper.js"),require("../../../../molecules/OakCollapsibleContent/OakCollapsibleContent.js");var o=require("../../../../molecules/OakDragAndDropInstructions/OakDragAndDropInstructions.js"),l=require("../../../../molecules/OakDraggable/OakDraggable.js"),i=require("../../../../molecules/OakDroppable/OakDroppable.js");require("../../../../molecules/OakHandDrawnFocusUnderline/OakHandDrawnFocusUnderline.js"),require("../../../../molecules/OakHandDrawnHR/OakHandDrawnHR.js"),require("../../../../molecules/InternalShadowRoundButton/InternalShadowRoundButton.js"),require("../../../../molecules/OakLink/OakLink.js"),require("../../../../molecules/OakLoadingSpinner/OakLoadingSpinner.js"),require("../../../../molecules/OakModal/OakModal.js"),require("../../../../molecules/OakModalCenter/OakModalCenter.js"),require("../../../../molecules/OakOutlineAccordion/OakOutlineAccordion.js"),require("../../../../molecules/InternalShadowRectButton/InternalShadowRectButton.js"),require("../../../../molecules/OakPromoTag/OakPromoTag.js"),require("../../../../molecules/OakRadioButton/OakRadioButton.js"),require("../../../../molecules/OakRadioGroup/OakRadioGroup.js"),require("../../../../molecules/OakRadioTile/OakRadioTile.js"),require("../../../../molecules/OakSecondaryLink/OakSecondaryLink.js"),require("../../../../molecules/OakFilterDrawer/OakFilterDrawer.js"),require("../../../../molecules/OakTextInput/OakTextInput.js"),require("react-dom"),require("../../../../atoms/InternalTooltip/InternalTooltip.js"),require("../../../../molecules/OakTimer/OakTimer.js"),require("../../../../molecules/OakCodeRenderer/OakCodeRenderer.js");var s=require("../../../../../animation/usePrefersReducedMotion.js"),u=require("../../../../atoms/InternalDndContext/InternalDndContext.js"),d=require("../../../../atoms/InternalClientPortal/InternalClientPortal.js");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var k=c(e);const O=({id:e,label:r,isOver:t})=>{const{attributes:n,listeners:o,setNodeRef:i,isDragging:s}=a.useDraggable({id:e,data:{id:e,label:r}});return k.default.createElement(l.OakDraggable,{ref:i,isDisabled:t,color:"text-inverted",background:"bg-btn-primary",iconColor:"icon-main",...n,...o,role:"option","aria-describedby":void 0,"aria-roledescription":"draggable item","aria-pressed":void 0,"aria-selected":!!n["aria-pressed"],style:{opacity:s?0:1}},r)},m=({children:e})=>{const{setNodeRef:r,isOver:n}=a.useDroppable({id:"holding-pen",data:{label:"holding pen"}});return k.default.createElement(t.InternalDroppableHoldingPen,{ref:r,isOver:n,"aria-label":"Available items","data-testid":"holding-pen",role:"listbox"},e)},g=({id:e,label:r,match:t,isHighlighted:n})=>{const{setNodeRef:o,isOver:l,active:s}=a.useDroppable({id:e,data:{id:e,label:r}});return k.default.createElement(i.OakDroppable,{isOver:l,isDisabled:!s,ref:o,id:e,labelSlot:r,"data-testid":"slot",isHighlighted:n},t&&k.default.createElement(O,{...t,isOver:l}))},p={onDragStart(){},onDragOver({active:e,over:a}){if(a?.data.current&&e.data?.current)return`Item ${e.data.current.label} is over ${a.data.current.label}`},onDragEnd({active:e,over:a}){if(a?.data.current&&e.data?.current)return`Item ${e.data.current.label} was dropped onto ${a.data.current.label}`},onDragCancel({active:e}){if(e.data?.current)return`Dragging was cancelled. Item ${e.data.current.label} was dropped.`}};exports.OakQuizMatch=({initialOptions:t,initialSlots:i,isHighlighted:c,onChange:q})=>{const[j,b]=e.useState({}),D=e.useRef(t.slice()).current,[f,h]=e.useState(D),I=e.useRef(i).current,[S,v]=e.useState(null),C=D.find((e=>e.id===S)),R=s.usePrefersReducedMotion(),y=a.useSensors(a.useSensor(a.MouseSensor),a.useSensor(a.TouchSensor),a.useSensor(a.KeyboardSensor,{coordinateGetter:r.sortableKeyboardCoordinates,scrollBehavior:R?"instant":"smooth"}));return e.useEffect((()=>{const e=Object.values(j).map((e=>e.id)),a=D.filter((a=>!e.includes(a.id)));h(a.sort((()=>Math.random()-.5)))}),[D,j]),k.default.createElement(k.default.Fragment,null,k.default.createElement(o.OakDragAndDropInstructions,{$mb:"space-between-m2"}),k.default.createElement(u.InternalDndContext,{sensors:y,collisionDetection:a.closestCenter,onDragEnd:function(e){const{active:a,over:r}=e;r&&b((e=>{const t=Object.entries(e).filter((([,e])=>e?.id!==a.id)),n=Object.fromEntries(t);return"holding-pen"!==r.id&&(n[r.id]=a.data.current),q?.(n),n}));v(null)},onDragStart:function(e){const{active:a}=e;v(a.id.toString())},accessibility:{announcements:p}},k.default.createElement(m,null,f.map((e=>k.default.createElement(O,{key:e.id,...e})))),k.default.createElement(n.OakFlex,{$gap:"space-between-s",$flexDirection:"column","aria-label":"Matched items",role:"listbox"},I.map((e=>k.default.createElement(g,{key:e.id,...e,isHighlighted:c,match:j[e.id]})))),k.default.createElement(d.InternalClientPortal,{show:!0},k.default.createElement(a.DragOverlay,{dropAnimation:R?null:void 0},C&&k.default.createElement(l.OakDraggable,{isDragging:!0},C.label)))))};
//# sourceMappingURL=OakQuizMatch.js.map
