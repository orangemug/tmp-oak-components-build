{"version":3,"file":"OakLessonNavItem.js","sources":["../../../../../../../src/components/organisms/pupil/lesson/OakLessonNavItem/OakLessonNavItem.tsx"],"sourcesContent":["import React, { ComponentPropsWithoutRef, ElementType } from \"react\";\nimport styled, { css } from \"styled-components\";\n\nimport {\n  OakBox,\n  OakFlex,\n  OakIcon,\n  OakIconName,\n  OakSpan,\n} from \"@/components/atoms\";\nimport { parseColor } from \"@/styles/helpers/parseColor\";\nimport { OakRoundIcon } from \"@/components/molecules\";\nimport { parseColorFilter } from \"@/styles/helpers/parseColorFilter\";\nimport { parseSpacing } from \"@/styles/helpers/parseSpacing\";\nimport { parseDropShadow } from \"@/styles/helpers/parseDropShadow\";\nimport { OakCombinedColorToken } from \"@/styles\";\n\ntype LessonSectionName = \"intro\" | \"starter-quiz\" | \"video\" | \"exit-quiz\";\n\ntype BaseOakLessonNavItemProps<C extends ElementType> = {\n  as?: C;\n  /**\n   * Disable the section preventing navigation to it.\n   */\n  disabled?: boolean;\n} & ComponentPropsWithoutRef<C>;\n\ntype QuizSectionProps = {\n  lessonSectionName: \"starter-quiz\" | \"exit-quiz\";\n  /**\n   * The number of questions in the quiz\n   */\n  numQuestions: number;\n  /**\n   * The number of questions answered correctly\n   */\n  grade: number;\n};\n\ntype VideoSectionProps = {\n  lessonSectionName: \"video\";\n};\n\ntype IntroSectionProps = {\n  lessonSectionName: \"intro\";\n};\n\ntype SectionProps = {\n  /**\n   * Denotes the progress in the lesson section\n   */\n  progress: \"not-started\" | \"in-progress\" | \"complete\";\n} & (IntroSectionProps | QuizSectionProps | VideoSectionProps);\n\nexport type OakLessonNavItemProps<C extends ElementType> =\n  BaseOakLessonNavItemProps<C> & SectionProps;\n\nconst StyledLabel = styled(OakBox)``;\n\nconst StyledRoundIcon = styled(OakRoundIcon)<{\n  $disabled?: boolean;\n}>`\n  width: ${parseSpacing(\"all-spacing-8\")};\n  height: ${parseSpacing(\"all-spacing-8\")};\n  padding: 0;\n\n  background: transparent;\n\n  img {\n    filter: ${(props) =>\n      parseColorFilter(props.$disabled ? \"icon-disabled\" : \"icon-inverted\")};\n  }\n`;\n\nconst activeIconStyles = css`\n  ${StyledRoundIcon} {\n    background: ${parseColor(\"bg-btn-primary\")};\n\n    img {\n      filter: ${parseColorFilter(\"icon-main\")};\n    }\n  }\n`;\n\nconst StyledLessonNavItem = styled(OakFlex)<{ $disabled?: boolean }>`\n  outline: none;\n  text-align: initial;\n\n  &:focus-visible {\n    box-shadow: ${parseDropShadow(\"drop-shadow-centered-lemon\")},\n      ${parseDropShadow(\"drop-shadow-centered-grey\")};\n  }\n\n  ${(props) => props.$disabled && \"cursor: default\"}\n\n  ${(props) =>\n    !props.$disabled &&\n    css`\n      cursor: pointer;\n\n      /* Don't apply hover styles on touch devices */\n      @media (hover: hover) {\n        &:hover {\n          ${StyledLabel} {\n            text-decoration: underline;\n          }\n\n          ${activeIconStyles}\n        }\n      }\n\n      &:active {\n        box-shadow: ${parseDropShadow(\"drop-shadow-lemon\")},\n          ${parseDropShadow(\"drop-shadow-grey\")};\n        ${activeIconStyles}\n      }\n    `}\n`;\n\nconst FlexedOakBox = styled(OakBox)`\n  flex: 1;\n`;\n\n/**\n * Enables navigation to the given section of a lesson as well as displaying current progress\n */\nexport const OakLessonNavItem = <C extends ElementType = \"a\">(\n  props: OakLessonNavItemProps<C>,\n) => {\n  const { as, lessonSectionName, progress, disabled, href, onClick, ...rest } =\n    props;\n  const [notStartedBackgroundColor, backgroundColor, borderColor] =\n    pickColorsForSection(lessonSectionName);\n\n  return (\n    <StyledLessonNavItem\n      as={disabled ? \"div\" : as ?? \"a\"}\n      $gap=\"space-between-m\"\n      $alignItems=\"center\"\n      $background={\n        progress === \"not-started\" ? notStartedBackgroundColor : backgroundColor\n      }\n      $ph={[\"inner-padding-m\", \"inner-padding-xl\"]}\n      $pv=\"inner-padding-l\"\n      $borderRadius=\"border-radius-l\"\n      $borderColor={borderColor}\n      $ba=\"border-solid-l\"\n      $disabled={disabled}\n      $color=\"text-primary\"\n      href={disabled ? undefined : href}\n      onClick={disabled ? undefined : onClick}\n      {...rest}\n    >\n      <OakFlex $width=\"all-spacing-13\" $justifyContent=\"center\">\n        <OakIcon\n          iconName={pickIconForSection(lessonSectionName)}\n          $width=\"all-spacing-10\"\n          $height=\"all-spacing-10\"\n        />\n      </OakFlex>\n      <FlexedOakBox>\n        <StyledLabel\n          as=\"strong\"\n          $font={[\"heading-6\", \"heading-5\"]}\n          $color={disabled ? \"text-disabled\" : \"text-primary\"}\n        >\n          {pickLabelForSection(lessonSectionName)}\n        </StyledLabel>\n        <OakBox $font={[\"body-2\", \"body-1\"]}>\n          {pickSummaryForProgress(props)}\n        </OakBox>\n      </FlexedOakBox>\n      {renderQuestionCounter(props)}\n      <StyledRoundIcon iconName=\"chevron-right\" $disabled={disabled} />\n    </StyledLessonNavItem>\n  );\n};\n\nfunction renderQuestionCounter(props: SectionProps) {\n  if (props.progress !== \"complete\") {\n    return null;\n  }\n\n  /**\n   * The large answer counter is only rendered when on a non-mobile screen\n   */\n  switch (props.lessonSectionName) {\n    case \"exit-quiz\":\n    case \"starter-quiz\":\n      return (\n        <OakBox $display={[\"none\", \"block\"]} $mr=\"space-between-m\">\n          <OakSpan $font=\"heading-4\">{props.grade}</OakSpan>\n          <OakSpan $font=\"heading-6\">&nbsp;/&nbsp;{props.numQuestions}</OakSpan>\n        </OakBox>\n      );\n    default:\n      return null;\n  }\n}\n\nfunction pickIconForSection(sectionName: LessonSectionName): OakIconName {\n  switch (sectionName) {\n    case \"intro\":\n      return \"intro\";\n    case \"starter-quiz\":\n    case \"exit-quiz\":\n      return \"quiz\";\n    case \"video\":\n      return \"video\";\n  }\n}\n\nfunction pickColorsForSection(\n  sectionName: LessonSectionName,\n): [\n  notStartedBackgroundColor: OakCombinedColorToken,\n  backgroundColor: OakCombinedColorToken,\n  borderColor: OakCombinedColorToken,\n] {\n  switch (sectionName) {\n    case \"intro\":\n      return [\n        \"bg-decorative2-very-subdued\",\n        \"bg-decorative2-main\",\n        \"border-decorative2-stronger\",\n      ];\n    case \"starter-quiz\":\n      return [\n        \"bg-decorative1-very-subdued\",\n        \"bg-decorative1-main\",\n        \"border-decorative1-stronger\",\n      ];\n    case \"video\":\n      return [\n        \"bg-decorative4-very-subdued\",\n        \"bg-decorative4-main\",\n        \"border-decorative4-stronger\",\n      ];\n    case \"exit-quiz\":\n      return [\n        \"bg-decorative5-very-subdued\",\n        \"bg-decorative5-main\",\n        \"border-decorative5-stronger\",\n      ];\n  }\n}\n\nfunction pickLabelForSection(sectionName: LessonSectionName): string {\n  switch (sectionName) {\n    case \"intro\":\n      return \"Introduction\";\n    case \"starter-quiz\":\n      return \"Starter quiz\";\n    case \"video\":\n      return \"Lesson video\";\n    case \"exit-quiz\":\n      return \"Exit quiz\";\n  }\n}\n\nfunction pickSummaryForProgress(props: SectionProps) {\n  switch (props.progress) {\n    case \"not-started\":\n      return pickSummaryForNotStarted(props);\n    case \"in-progress\":\n      return \"In progress...\";\n    case \"complete\":\n      return (\n        <OakFlex $gap=\"space-between-sssx\" $alignItems=\"center\">\n          <OakIcon\n            iconName=\"tick\"\n            $width=\"all-spacing-6\"\n            $height=\"all-spacing-6\"\n          />\n          {pickSummaryForComplete(props)}\n        </OakFlex>\n      );\n  }\n}\n\nfunction pickSummaryForNotStarted(props: SectionProps) {\n  switch (props.lessonSectionName) {\n    case \"intro\":\n      return \"Prepare\";\n    case \"starter-quiz\":\n      return `Activate - ${props.numQuestions} Questions`;\n    case \"exit-quiz\":\n      return `Check - ${props.numQuestions} questions`;\n    case \"video\":\n      return \"Learn\";\n  }\n}\n\nfunction pickSummaryForComplete(props: SectionProps) {\n  switch (props.lessonSectionName) {\n    case \"intro\":\n    case \"video\":\n      return \"Completed\";\n    case \"starter-quiz\":\n    case \"exit-quiz\":\n      // The counter is rendered as the summary next\n      // when on a mobile device, so it is hidden on larger screens\n      return (\n        <>\n          <OakBox $display={[\"none\", \"block\"]}>Completed</OakBox>\n          <OakBox $display={[\"block\", \"none\"]}>\n            {props.grade}/{props.numQuestions} correct\n          </OakBox>\n        </>\n      );\n  }\n}\n"],"names":["StyledLabel","styled","default","OakBox","StyledRoundIcon","OakRoundIcon","parseSpacing","props","parseColorFilter","$disabled","activeIconStyles","css","parseColor","StyledLessonNavItem","OakFlex","parseDropShadow","FlexedOakBox","pickIconForSection","sectionName","as","lessonSectionName","progress","disabled","href","onClick","rest","notStartedBackgroundColor","backgroundColor","borderColor","pickColorsForSection","React","createElement","$gap","$alignItems","$background","$ph","$pv","$borderRadius","$borderColor","$color","undefined","$width","$justifyContent","OakIcon","iconName","$height","$font","pickLabelForSection","numQuestions","pickSummaryForNotStarted","Fragment","$display","grade","pickSummaryForComplete","pickSummaryForProgress","$mr","OakSpan","renderQuestionCounter"],"mappings":"m0HAyDA,MAAMA,EAAcC,EAAMC,QAACC,SAAO,GAE5BC,EAAkBH,EAAAA,QAAOI,EAAYA,aAEzC;WACSC,EAAAA,aAAa;YACZA,EAAAA,aAAa;;;;;;cAMVC,GACTC,mBAAiBD,EAAME,UAAY,gBAAkB;;EAIrDC,EAAmBC,EAAGA,GAAA;IACxBP;kBACcQ,EAAAA,WAAW;;;gBAGbJ,EAAAA,iBAAiB;;;EAK3BK,EAAsBZ,EAAAA,QAAOa,EAAOA,QAA0B;;;;;kBAKlDC,EAAAA,gBAAgB;QAC1BA,EAAAA,gBAAgB;;;IAGnBR,GAAUA,EAAME,WAAa;;IAE7BF,IACAA,EAAME,WACPE,EAAAA,GAAG;;;;;;YAMKX;;;;YAIAU;;;;;sBAKUK,EAAAA,gBAAgB;YAC1BA,EAAAA,gBAAgB;UAClBL;;;EAKJM,EAAef,EAAAA,QAAOE,EAAMA,OAAC;;EAiFnC,SAASc,EAAmBC,GAC1B,OAAQA,GACN,IAAK,QACH,MAAO,QACT,IAAK,eACL,IAAK,YACH,MAAO,OACT,IAAK,QACH,MAAO,QAEb,0BAnFEX,IAEA,MAAMY,GAAEA,EAAEC,kBAAEA,EAAiBC,SAAEA,EAAQC,SAAEA,EAAQC,KAAEA,EAAIC,QAAEA,KAAYC,GACnElB,GACKmB,EAA2BC,EAAiBC,GAiFrD,SACEV,GAMA,OAAQA,GACN,IAAK,QACH,MAAO,CACL,8BACA,sBACA,+BAEJ,IAAK,eACH,MAAO,CACL,8BACA,sBACA,+BAEJ,IAAK,QACH,MAAO,CACL,8BACA,sBACA,+BAEJ,IAAK,YACH,MAAO,CACL,8BACA,sBACA,+BAGR,CAjHIW,CAAqBT,GAEvB,OACEU,EAAC5B,QAAA6B,cAAAlB,EACC,CAAAM,GAAIG,EAAW,MAAQH,GAAM,IAAGa,KAC3B,kBAAiBC,YACV,SAEVC,YAAa,gBAAbb,EAA6BK,EAA4BC,EAEtDQ,IAAA,CAAC,kBAAmB,oBAAmBC,IACxC,kBACUC,cAAA,kBACAC,aAAAV,MACV,iBAAgBnB,UACTa,EAAQiB,OACZ,eACPhB,KAAMD,OAAWkB,EAAYjB,EAC7BC,QAASF,OAAWkB,EAAYhB,KAC5BC,GAEJK,EAAA5B,QAAA6B,cAACjB,UAAO,CAAA2B,OAAQ,iBAAgBC,gBAAiB,UAC/CZ,EAAAA,QAAAC,cAACY,UAAO,CACNC,SAAU3B,EAAmBG,GACtBqB,OAAA,iBACCI,QAAA,oBAGZf,UAAAC,cAACf,EAAY,KACXc,EAAC5B,QAAA6B,cAAA/B,EACC,CAAAmB,GAAG,SACI2B,MAAA,CAAC,YAAa,aACbP,OAAAjB,EAAW,gBAAkB,gBAmF/C,SAA6BJ,GAC3B,OAAQA,GACN,IAAK,QACH,MAAO,eACT,IAAK,eACH,MAAO,eACT,IAAK,QACH,MAAO,eACT,IAAK,YACH,MAAO,YAEb,CA5FW6B,CAAoB3B,IAEvBU,EAAAA,QAAAC,cAAC5B,SAAM,CAAA2C,MAAQ,CAAC,SAAU,WA4FlC,SAAgCvC,GAC9B,OAAQA,EAAMc,UACZ,IAAK,cACH,OAiBN,SAAkCd,GAChC,OAAQA,EAAMa,mBACZ,IAAK,QACH,MAAO,UACT,IAAK,eACH,MAAO,cAAcb,EAAMyC,yBAC7B,IAAK,YACH,MAAO,WAAWzC,EAAMyC,yBAC1B,IAAK,QACH,MAAO,QAEb,CA5BaC,CAAyB1C,GAClC,IAAK,cACH,MAAO,iBACT,IAAK,WACH,OACEuB,EAAAA,QAACC,cAAAjB,EAAOA,QAAM,CAAAkB,KAAA,iCAAiC,UAC7CF,UAACC,cAAAY,EAAOA,SACNC,SAAS,OACFH,OAAA,gBACCI,QAAA,kBAqBpB,SAAgCtC,GAC9B,OAAQA,EAAMa,mBACZ,IAAK,QACL,IAAK,QACH,MAAO,YACT,IAAK,eACL,IAAK,YAGH,OACEU,UAAAC,cAAAD,EAAA5B,QAAAgD,SAAA,KACEpB,UAAAC,cAAC5B,EAAAA,OAAiB,CAAAgD,SAAA,CAAC,OAAQ,UAA4B,aACvDrB,EAAA5B,QAAA6B,cAAC5B,SAAiB,CAAAgD,SAAA,CAAC,QAAS,SACzB5C,EAAM6C,UAAQ7C,EAAMyC,aACd,aAInB,CArCWK,CAAuB9C,IAIlC,CA7GW+C,CAAuB/C,KASlC,SAA+BA,GAC7B,GAAuB,aAAnBA,EAAMc,SACR,OAAO,KAMT,OAAQd,EAAMa,mBACZ,IAAK,YACL,IAAK,eACH,OACEU,EAAC5B,QAAA6B,cAAA5B,EAAAA,OAAiB,CAAAgD,SAAA,CAAC,OAAQ,SAAQI,IAAM,mBACvCzB,EAAA5B,QAAA6B,cAACyB,UAAc,CAAAV,MAAA,aAAavC,EAAM6C,OAClCtB,EAAAA,QAACC,cAAAyB,EAAAA,eAAc,mBAA0BjD,EAAMyC,eAGrD,QACE,OAAO,KAEb,CA1BOS,CAAsBlD,GACvBuB,UAACC,cAAA3B,EAAgB,CAAAwC,SAAS,0BAA2BtB,IAEvD"}