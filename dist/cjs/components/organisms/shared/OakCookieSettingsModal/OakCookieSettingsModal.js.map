{"version":3,"file":"OakCookieSettingsModal.js","sources":["../../../../../../src/components/organisms/shared/OakCookieSettingsModal/OakCookieSettingsModal.tsx"],"sourcesContent":["import React, { FormEvent } from \"react\";\n\nimport {\n  Consent,\n  PolicyConsent,\n} from \"@/components/organisms/shared/OakCookieConsentProvider\";\nimport {\n  OakAccordion,\n  OakCheckBox,\n  OakLink,\n  OakModal,\n  OakModalBody,\n  OakModalFooter,\n  OakModalProps,\n  OakPrimaryButton,\n  OakSecondaryButton,\n  OakSecondaryLink,\n} from \"@/components/molecules\";\nimport { OakBox, OakHeading, OakP, OakSpan, OakUL } from \"@/components/atoms\";\n\nexport type OakCookieSettingsModalProps = Pick<\n  OakModalProps,\n  \"isOpen\" | \"onClose\" | \"zIndex\"\n> & {\n  /**\n   * Triggered when the user rejects all non-essential cookies.\n   */\n  onReject(): void;\n  /**\n   * Triggered when the user confirms their cookie consent settings.\n   * @param consents The user's chosen consent settings.\n   */\n  onConfirm(consents: Consent[]): void;\n  /**\n   * Triggered when the user accepts all cookies.\n   */\n  onAccept(): void;\n  /**\n   * URL of the site's cookie policy.\n   */\n  policyURL: string;\n  /**\n   * List of cookie policies with the current consent state.\n   */\n  policyConsents: PolicyConsent[];\n};\n\n/**\n * Modal for managing cookie consent settings.\n */\nexport const OakCookieSettingsModal = ({\n  isOpen,\n  onClose,\n  onReject,\n  onConfirm,\n  onAccept,\n  policyURL,\n  policyConsents,\n  zIndex,\n}: OakCookieSettingsModalProps) => {\n  const handleSubmit = (event: FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    const formData = new FormData(event.currentTarget);\n    const newConsents: Record<string, Consent> = {};\n\n    for (const { policyId, isStrictlyNecessary } of policyConsents) {\n      newConsents[policyId] = {\n        policyId,\n        consentState: isStrictlyNecessary ? \"granted\" : \"denied\",\n      };\n    }\n\n    for (const policyId of formData.getAll(\"consent\")) {\n      newConsents[policyId.toString()] = {\n        policyId: policyId.toString(),\n        consentState: \"granted\",\n      };\n    }\n\n    onConfirm(Object.values(newConsents));\n  };\n\n  return (\n    <OakModal\n      isOpen={isOpen}\n      onClose={onClose}\n      zIndex={zIndex}\n      footerSlot={\n        <OakModalFooter>\n          <OakSecondaryButton onClick={onReject} width=\"100%\">\n            Reject non-essential cookies\n          </OakSecondaryButton>\n          <OakPrimaryButton\n            type=\"submit\"\n            form=\"cookie-settings-form\"\n            width=\"100%\"\n          >\n            Confirm my choices\n          </OakPrimaryButton>\n        </OakModalFooter>\n      }\n    >\n      <OakModalBody>\n        <OakHeading tag=\"h2\" $font=\"heading-5\" $mb=\"space-between-s\">\n          This site uses cookies to store information on your computer.\n        </OakHeading>\n        <OakP $mb=\"space-between-m\">\n          Some of these cookies are essential, while others help us to improve\n          your experience by providing insights into how the site is being used.\n        </OakP>\n\n        <OakP $mb=\"space-between-l\">\n          For more information, view our{\" \"}\n          <OakLink href={policyURL} target=\"_blank\">\n            cookie policy\n          </OakLink>\n          .\n        </OakP>\n        <OakBox $mb=\"space-between-xl\">\n          <OakPrimaryButton onClick={onAccept} width=\"all-spacing-18\">\n            Allow all\n          </OakPrimaryButton>\n        </OakBox>\n        <OakBox\n          $ph=\"inner-padding-xs\"\n          as=\"form\"\n          id=\"cookie-settings-form\"\n          onSubmit={handleSubmit}\n        >\n          <OakHeading tag=\"h3\" $font=\"heading-6\" $mb=\"space-between-m\">\n            Manage consent preferences\n          </OakHeading>\n          {policyConsents.map((policy) => {\n            return (\n              <OakAccordion\n                key={policy.policyId}\n                header={\n                  <OakSpan id={`cookie-settings-${policy.policyId}-label`}>\n                    {policy.policyLabel}\n                  </OakSpan>\n                }\n                id={`cookies-settings-${policy.policyId}-accordion`}\n                headerAfterSlot={\n                  <OakCheckBox\n                    id={`cookies-settings-${policy.policyId}-checkbox`}\n                    name=\"consent\"\n                    displayValue=\"\"\n                    value={policy.policyId}\n                    defaultChecked={\n                      policy.isStrictlyNecessary ||\n                      policy.consentState === \"granted\"\n                    }\n                    disabled={policy.isStrictlyNecessary}\n                    aria-labelledby={`cookie-settings-${policy.policyId}-label`}\n                  />\n                }\n              >\n                <OakP $mb=\"space-between-m2\">{policy.policyDescription}</OakP>\n                <OakBox as=\"dl\" $pl=\"inner-padding-m\">\n                  {policy.policyParties.length > 0 && (\n                    <>\n                      <dt>Who do we share data with?</dt>\n                      <OakBox as=\"dd\" $font=\"body-3-bold\" $mb=\"space-between-s\">\n                        <OakUL $reset>\n                          {policy.policyParties.map((party, index, all) => (\n                            <OakBox as=\"li\" key={index} $display=\"inline\">\n                              <OakSecondaryLink\n                                href={party.url}\n                                target=\"_blank\"\n                                rel=\"external nofollow\"\n                              >\n                                {party.name}\n                              </OakSecondaryLink>\n                              {index < all.length - 1 && \", \"}\n                            </OakBox>\n                          ))}\n                        </OakUL>\n                      </OakBox>\n                    </>\n                  )}\n                  <dt>Does this policy need cookies to work?</dt>\n                  <OakBox as=\"dd\" $font=\"body-3-bold\">\n                    Yes.\n                  </OakBox>\n                </OakBox>\n              </OakAccordion>\n            );\n          })}\n        </OakBox>\n      </OakModalBody>\n    </OakModal>\n  );\n};\n"],"names":["isOpen","onClose","onReject","onConfirm","onAccept","policyURL","policyConsents","zIndex","React","createElement","OakModal","footerSlot","OakModalFooter","OakSecondaryButton","onClick","width","OakPrimaryButton","type","form","OakModalBody","OakHeading","tag","$font","$mb","default","OakP","OakLink","href","target","OakBox","$ph","as","id","onSubmit","event","preventDefault","formData","FormData","currentTarget","newConsents","policyId","isStrictlyNecessary","consentState","getAll","toString","Object","values","map","policy","OakAccordion","key","header","OakSpan","policyLabel","headerAfterSlot","OakCheckBox","name","displayValue","value","defaultChecked","disabled","policyDescription","policyParties","length","Fragment","OakUL","$reset","party","index","all","OakSecondaryLink","url","rel"],"mappings":"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"}