{"version":3,"file":"OakLessonNavItem.js","sources":["../../../../../../../src/components/organisms/pupil/lesson/OakLessonNavItem/OakLessonNavItem.tsx"],"sourcesContent":["import React, { ComponentPropsWithoutRef, ElementType } from \"react\";\nimport styled, { css } from \"styled-components\";\n\nimport {\n  OakBox,\n  OakFlex,\n  OakIcon,\n  OakIconName,\n  OakSpan,\n} from \"@/components/atoms\";\nimport { parseColor } from \"@/styles/helpers/parseColor\";\nimport { OakRoundIcon } from \"@/components/molecules\";\nimport { parseColorFilter } from \"@/styles/helpers/parseColorFilter\";\nimport { parseSpacing } from \"@/styles/helpers/parseSpacing\";\nimport { parseDropShadow } from \"@/styles/helpers/parseDropShadow\";\nimport { OakCombinedColorToken } from \"@/styles\";\n\ntype LessonSectionName = \"intro\" | \"starter-quiz\" | \"video\" | \"exit-quiz\";\n\ntype BaseOakLessonNavItemProps<C extends ElementType> = {\n  as?: C;\n  /**\n   * Disable the section preventing navigation to it.\n   */\n  disabled?: boolean;\n} & ComponentPropsWithoutRef<C>;\n\ntype QuizSectionProps = {\n  lessonSectionName: \"starter-quiz\" | \"exit-quiz\";\n  /**\n   * The number of questions in the quiz\n   */\n  numQuestions: number;\n  /**\n   * The number of questions answered correctly\n   */\n  grade: number;\n};\n\ntype VideoSectionProps = {\n  lessonSectionName: \"video\";\n};\n\ntype IntroSectionProps = {\n  lessonSectionName: \"intro\";\n};\n\ntype SectionProps = {\n  /**\n   * Denotes the progress in the lesson section\n   */\n  progress: \"not-started\" | \"in-progress\" | \"complete\";\n} & (IntroSectionProps | QuizSectionProps | VideoSectionProps);\n\nexport type OakLessonNavItemProps<C extends ElementType> =\n  BaseOakLessonNavItemProps<C> & SectionProps;\n\nconst StyledLabel = styled(OakBox)``;\n\nconst StyledRoundIcon = styled(OakRoundIcon)<{\n  $disabled?: boolean;\n}>`\n  width: ${parseSpacing(\"all-spacing-8\")};\n  height: ${parseSpacing(\"all-spacing-8\")};\n  padding: 0;\n\n  background: transparent;\n\n  img {\n    filter: ${(props) =>\n      parseColorFilter(props.$disabled ? \"icon-disabled\" : \"icon-inverted\")};\n  }\n`;\n\nconst activeIconStyles = css`\n  ${StyledRoundIcon} {\n    background: ${parseColor(\"bg-btn-primary\")};\n\n    img {\n      filter: ${parseColorFilter(\"icon-main\")};\n    }\n  }\n`;\n\nconst StyledLessonNavItem = styled(OakFlex)<{ $disabled?: boolean }>`\n  outline: none;\n  text-align: initial;\n\n  &:focus-visible {\n    box-shadow: ${parseDropShadow(\"drop-shadow-centered-lemon\")},\n      ${parseDropShadow(\"drop-shadow-centered-grey\")};\n  }\n\n  ${(props) => props.$disabled && \"cursor: default\"}\n\n  ${(props) =>\n    !props.$disabled &&\n    css`\n      cursor: pointer;\n\n      /* Don't apply hover styles on touch devices */\n      @media (hover: hover) {\n        &:hover {\n          ${StyledLabel} {\n            text-decoration: underline;\n          }\n\n          ${activeIconStyles}\n        }\n      }\n\n      &:active {\n        box-shadow: ${parseDropShadow(\"drop-shadow-lemon\")},\n          ${parseDropShadow(\"drop-shadow-grey\")};\n        ${activeIconStyles}\n      }\n    `}\n`;\n\nconst FlexedOakBox = styled(OakBox)`\n  flex: 1;\n`;\n\n/**\n * Enables navigation to the given section of a lesson as well as displaying current progress\n */\nexport const OakLessonNavItem = <C extends ElementType = \"a\">(\n  props: OakLessonNavItemProps<C>,\n) => {\n  const { as, lessonSectionName, progress, disabled, href, onClick, ...rest } =\n    props;\n  const [notStartedBackgroundColor, backgroundColor, borderColor] =\n    pickColorsForSection(lessonSectionName);\n\n  return (\n    <StyledLessonNavItem\n      as={disabled ? \"div\" : as ?? \"a\"}\n      $gap=\"space-between-m\"\n      $alignItems=\"center\"\n      $background={\n        progress === \"not-started\" ? notStartedBackgroundColor : backgroundColor\n      }\n      $ph={[\"inner-padding-m\", \"inner-padding-xl\"]}\n      $pv=\"inner-padding-l\"\n      $borderRadius=\"border-radius-l\"\n      $borderColor={borderColor}\n      $ba=\"border-solid-l\"\n      $disabled={disabled}\n      $color=\"text-primary\"\n      href={disabled ? undefined : href}\n      onClick={disabled ? undefined : onClick}\n      {...rest}\n    >\n      <OakFlex $width=\"all-spacing-13\" $justifyContent=\"center\">\n        <OakIcon\n          iconName={pickIconForSection(lessonSectionName)}\n          $width=\"all-spacing-10\"\n          $height=\"all-spacing-10\"\n        />\n      </OakFlex>\n      <FlexedOakBox>\n        <StyledLabel\n          as=\"strong\"\n          $font={[\"heading-6\", \"heading-5\"]}\n          $color={disabled ? \"text-disabled\" : \"text-primary\"}\n        >\n          {pickLabelForSection(lessonSectionName)}\n        </StyledLabel>\n        <OakBox $font={[\"body-2\", \"body-1\"]}>\n          {pickSummaryForProgress(props)}\n        </OakBox>\n      </FlexedOakBox>\n      {renderQuestionCounter(props)}\n      <StyledRoundIcon iconName=\"chevron-right\" $disabled={disabled} />\n    </StyledLessonNavItem>\n  );\n};\n\nfunction renderQuestionCounter(props: SectionProps) {\n  if (props.progress !== \"complete\") {\n    return null;\n  }\n\n  /**\n   * The large answer counter is only rendered when on a non-mobile screen\n   */\n  switch (props.lessonSectionName) {\n    case \"exit-quiz\":\n    case \"starter-quiz\":\n      return (\n        <OakBox $display={[\"none\", \"block\"]} $mr=\"space-between-m\">\n          <OakSpan $font=\"heading-4\">{props.grade}</OakSpan>\n          <OakSpan $font=\"heading-6\">&nbsp;/&nbsp;{props.numQuestions}</OakSpan>\n        </OakBox>\n      );\n    default:\n      return null;\n  }\n}\n\nfunction pickIconForSection(sectionName: LessonSectionName): OakIconName {\n  switch (sectionName) {\n    case \"intro\":\n      return \"intro\";\n    case \"starter-quiz\":\n    case \"exit-quiz\":\n      return \"quiz\";\n    case \"video\":\n      return \"video\";\n  }\n}\n\nfunction pickColorsForSection(\n  sectionName: LessonSectionName,\n): [\n  notStartedBackgroundColor: OakCombinedColorToken,\n  backgroundColor: OakCombinedColorToken,\n  borderColor: OakCombinedColorToken,\n] {\n  switch (sectionName) {\n    case \"intro\":\n      return [\n        \"bg-decorative2-very-subdued\",\n        \"bg-decorative2-main\",\n        \"border-decorative2-stronger\",\n      ];\n    case \"starter-quiz\":\n      return [\n        \"bg-decorative1-very-subdued\",\n        \"bg-decorative1-main\",\n        \"border-decorative1-stronger\",\n      ];\n    case \"video\":\n      return [\n        \"bg-decorative4-very-subdued\",\n        \"bg-decorative4-main\",\n        \"border-decorative4-stronger\",\n      ];\n    case \"exit-quiz\":\n      return [\n        \"bg-decorative5-very-subdued\",\n        \"bg-decorative5-main\",\n        \"border-decorative5-stronger\",\n      ];\n  }\n}\n\nfunction pickLabelForSection(sectionName: LessonSectionName): string {\n  switch (sectionName) {\n    case \"intro\":\n      return \"Introduction\";\n    case \"starter-quiz\":\n      return \"Starter quiz\";\n    case \"video\":\n      return \"Lesson video\";\n    case \"exit-quiz\":\n      return \"Exit quiz\";\n  }\n}\n\nfunction pickSummaryForProgress(props: SectionProps) {\n  switch (props.progress) {\n    case \"not-started\":\n      return pickSummaryForNotStarted(props);\n    case \"in-progress\":\n      return \"In progress...\";\n    case \"complete\":\n      return (\n        <OakFlex $gap=\"space-between-sssx\" $alignItems=\"center\">\n          <OakIcon\n            iconName=\"tick\"\n            $width=\"all-spacing-6\"\n            $height=\"all-spacing-6\"\n          />\n          {pickSummaryForComplete(props)}\n        </OakFlex>\n      );\n  }\n}\n\nfunction pickSummaryForNotStarted(props: SectionProps) {\n  switch (props.lessonSectionName) {\n    case \"intro\":\n      return \"Prepare\";\n    case \"starter-quiz\":\n      return `Activate - ${props.numQuestions} Questions`;\n    case \"exit-quiz\":\n      return `Check - ${props.numQuestions} questions`;\n    case \"video\":\n      return \"Learn\";\n  }\n}\n\nfunction pickSummaryForComplete(props: SectionProps) {\n  switch (props.lessonSectionName) {\n    case \"intro\":\n    case \"video\":\n      return \"Completed\";\n    case \"starter-quiz\":\n    case \"exit-quiz\":\n      // The counter is rendered as the summary next\n      // when on a mobile device, so it is hidden on larger screens\n      return (\n        <>\n          <OakBox $display={[\"none\", \"block\"]}>Completed</OakBox>\n          <OakBox $display={[\"block\", \"none\"]}>\n            {props.grade}/{props.numQuestions} correct\n          </OakBox>\n        </>\n      );\n  }\n}\n"],"names":["StyledLabel","styled","OakBox","StyledRoundIcon","OakRoundIcon","parseSpacing","props","parseColorFilter","$disabled","activeIconStyles","css","parseColor","StyledLessonNavItem","OakFlex","parseDropShadow","FlexedOakBox","OakLessonNavItem","as","lessonSectionName","progress","disabled","href","onClick","rest","notStartedBackgroundColor","backgroundColor","borderColor","sectionName","pickColorsForSection","React","createElement","$gap","$alignItems","$background","$ph","$pv","$borderRadius","$borderColor","$color","undefined","$width","$justifyContent","OakIcon","iconName","pickIconForSection","$height","$font","pickLabelForSection","numQuestions","pickSummaryForNotStarted","Fragment","$display","grade","pickSummaryForComplete","pickSummaryForProgress","$mr","OakSpan","renderQuestionCounter"],"mappings":"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"}