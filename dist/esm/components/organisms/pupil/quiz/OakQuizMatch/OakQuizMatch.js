import e,{useState as a,useRef as t,useEffect as o}from"react";import{useSensors as r,useSensor as i,MouseSensor as n,TouchSensor as l,KeyboardSensor as s,closestCenter as m,DragOverlay as d,useDraggable as c,useDroppable as p}from"@dnd-kit/core";import{sortableKeyboardCoordinates as k}from"@dnd-kit/sortable";import{InternalDroppableHoldingPen as O}from"../InternalDroppableHoldingPen/InternalDroppableHoldingPen.js";import"../../../../atoms/OakAnchorTarget/OakAnchorTarget.js";import"../../../../atoms/OakAspectRatio/OakAspectRatio.js";import"../../../../atoms/OakBox/OakBox.js";import"../../../../atoms/OakCloudinaryImage/OakCloudinaryImage.js";import{OakFlex as u}from"../../../../atoms/OakFlex/OakFlex.js";import"../../../../atoms/OakForm/OakForm.js";import"../../../../atoms/OakGlobalStyle/OakGlobalStyle.js";import"../../../../atoms/OakGrid/OakGrid.js";import"../../../../atoms/OakGridArea/OakGridArea.js";import"../../../../atoms/OakHeading/OakHeading.js";import"../../../../atoms/OakImage/OakImage.js";import"../../../../atoms/OakSpan/OakSpan.js";import"../../../../atoms/OakLI/OakLI.js";import"../../../../atoms/OakLabel/OakLabel.js";import"../../../../atoms/OakMaxWidth/OakMaxWidth.js";import"../../../../atoms/OakOL/OakOL.js";import"../../../../atoms/OakFieldset/OakFieldset.js";import"../../../../atoms/OakP/OakP.js";import"../../../../atoms/OakScreenReader/OakScreenReader.js";import"styled-components";import"../../../../atoms/OakTypography/OakTypography.js";import"../../../../atoms/OakUL/OakUL.js";import"../../../../atoms/OakSvg/OakSvg.js";import"../../../../molecules/OakAccordion/OakAccordion.js";import"../../../../molecules/OakBackLink/OakBackLink.js";import"../../../../molecules/OakButtonAsRadioGroup/OakButtonAsRadioGroup.js";import"../../../../atoms/InternalCardWithBackgroundElement/InternalCardWithBackgroundElement.js";import"../../../../atoms/InternalStyledSvg/InternalStyledSvg.js";import"../../../../atoms/InternalCheckBox/InternalCheckBox.js";import"../../../../atoms/InternalCheckBoxLabel/InternalCheckBoxLabel.js";import"../../../../atoms/InternalCheckBoxWrapper/InternalCheckBoxWrapper.js";import"../../../../molecules/OakCollapsibleContent/OakCollapsibleContent.js";import{OakDragAndDropInstructions as g}from"../../../../molecules/OakDragAndDropInstructions/OakDragAndDropInstructions.js";import{OakDraggable as j}from"../../../../molecules/OakDraggable/OakDraggable.js";import{OakDroppable as b}from"../../../../molecules/OakDroppable/OakDroppable.js";import"../../../../molecules/OakHandDrawnFocusUnderline/OakHandDrawnFocusUnderline.js";import"../../../../molecules/OakHandDrawnHR/OakHandDrawnHR.js";import"../../../../molecules/InternalShadowRoundButton/InternalShadowRoundButton.js";import"../../../../molecules/OakLink/OakLink.js";import"../../../../molecules/OakLoadingSpinner/OakLoadingSpinner.js";import"../../../../molecules/OakModal/OakModal.js";import"../../../../molecules/OakModalCenter/OakModalCenter.js";import"../../../../molecules/OakOutlineAccordion/OakOutlineAccordion.js";import"../../../../molecules/InternalShadowRectButton/InternalShadowRectButton.js";import"../../../../molecules/OakPromoTag/OakPromoTag.js";import"../../../../molecules/OakRadioButton/OakRadioButton.js";import"../../../../molecules/OakRadioGroup/OakRadioGroup.js";import"../../../../molecules/OakRadioTile/OakRadioTile.js";import"../../../../molecules/OakSecondaryLink/OakSecondaryLink.js";import"../../../../molecules/OakFilterDrawer/OakFilterDrawer.js";import"../../../../molecules/OakTextInput/OakTextInput.js";import"react-dom";import"../../../../atoms/InternalTooltip/InternalTooltip.js";import"../../../../molecules/OakTimer/OakTimer.js";import"../../../../molecules/OakCodeRenderer/OakCodeRenderer.js";import{usePrefersReducedMotion as h}from"../../../../../animation/usePrefersReducedMotion.js";import{InternalDndContext as I}from"../../../../atoms/InternalDndContext/InternalDndContext.js";import{InternalClientPortal as D}from"../../../../atoms/InternalClientPortal/InternalClientPortal.js";const f=({id:a,label:t,isOver:o})=>{const{attributes:r,listeners:i,setNodeRef:n,isDragging:l}=c({id:a,data:{id:a,label:t}});return e.createElement(j,{ref:n,isDisabled:o,color:"text-inverted",background:"bg-btn-primary",iconColor:"icon-main",...r,...i,role:"option","aria-describedby":void 0,"aria-roledescription":"draggable item","aria-pressed":void 0,"aria-selected":!!r["aria-pressed"],style:{opacity:l?0:1}},t)},v=({children:a})=>{const{setNodeRef:t,isOver:o}=p({id:"holding-pen",data:{label:"holding pen"}});return e.createElement(O,{ref:t,isOver:o,"aria-label":"Available items","data-testid":"holding-pen",role:"listbox"},a)},C=({id:a,label:t,match:o,isHighlighted:r})=>{const{setNodeRef:i,isOver:n,active:l}=p({id:a,data:{id:a,label:t}});return e.createElement(b,{isOver:n,isDisabled:!l,ref:i,id:a,labelSlot:t,"data-testid":"slot",isHighlighted:r},o&&e.createElement(f,{...o,isOver:n}))},S=({initialOptions:c,initialSlots:p,isHighlighted:O,onChange:b})=>{const[S,x]=a({}),B=t(c.slice()).current,[y,E]=a(B),L=t(p).current,[w,A]=a(null),H=B.find((e=>e.id===w)),T=h(),F=r(i(n),i(l),i(s,{coordinateGetter:k,scrollBehavior:T?"instant":"smooth"}));return o((()=>{const e=Object.values(S).map((e=>e.id)),a=B.filter((a=>!e.includes(a.id)));E(a.sort((()=>Math.random()-.5)))}),[B,S]),e.createElement(e.Fragment,null,e.createElement(g,{$mb:"space-between-m2"}),e.createElement(I,{sensors:F,collisionDetection:m,onDragEnd:function(e){const{active:a,over:t}=e;t&&x((e=>{const o=Object.entries(e).filter((([,e])=>e?.id!==a.id)),r=Object.fromEntries(o);return"holding-pen"!==t.id&&(r[t.id]=a.data.current),b?.(r),r}));A(null)},onDragStart:function(e){const{active:a}=e;A(a.id.toString())},accessibility:{announcements:R}},e.createElement(v,null,y.map((a=>e.createElement(f,{key:a.id,...a})))),e.createElement(u,{$gap:"space-between-s",$flexDirection:"column","aria-label":"Matched items",role:"listbox"},L.map((a=>e.createElement(C,{key:a.id,...a,isHighlighted:O,match:S[a.id]})))),e.createElement(D,{show:!0},e.createElement(d,{dropAnimation:T?null:void 0},H&&e.createElement(j,{isDragging:!0},H.label)))))},R={onDragStart(){},onDragOver({active:e,over:a}){if(a?.data.current&&e.data?.current)return`Item ${e.data.current.label} is over ${a.data.current.label}`},onDragEnd({active:e,over:a}){if(a?.data.current&&e.data?.current)return`Item ${e.data.current.label} was dropped onto ${a.data.current.label}`},onDragCancel({active:e}){if(e.data?.current)return`Dragging was cancelled. Item ${e.data.current.label} was dropped.`}};export{S as OakQuizMatch};
//# sourceMappingURL=OakQuizMatch.js.map
